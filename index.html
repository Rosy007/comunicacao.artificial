<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seu Espa√ßo de Bem-Estar üíô</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      padding: 40px;
      border-radius: 30px;
      width: 100%;
      max-width: 600px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    h1 {
      color: #667eea;
      text-align: center;
      margin-bottom: 15px;
      font-size: 2em;
      font-weight: 700;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 0.95em;
    }

    .emoji-header {
      text-align: center;
      font-size: 3em;
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }

    button {
      width: 100%;
      padding: 18px;
      margin: 12px 0;
      border: none;
      border-radius: 15px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      position: relative;
      overflow: hidden;
    }

    button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    button:hover::before {
      width: 300px;
      height: 300px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #f093fb, #f5576c);
      color: white;
      box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(245, 87, 108, 0.6);
    }

    .btn-success {
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      color: white;
      box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(79, 172, 254, 0.6);
    }

    .btn-warning {
      background: linear-gradient(135deg, #fa709a, #fee140);
      color: white;
      box-shadow: 0 4px 15px rgba(250, 112, 154, 0.4);
    }

    .btn-back {
      background: #e0e0e0;
      color: #333;
      padding: 12px;
      margin-top: 20px;
    }

    .btn-back:hover {
      background: #d0d0d0;
      transform: translateY(-2px);
    }

    textarea {
      width: 100%;
      padding: 15px;
      border-radius: 15px;
      border: 2px solid #e0e0e0;
      font-size: 15px;
      font-family: 'Poppins', sans-serif;
      margin-bottom: 20px;
      resize: vertical;
      min-height: 120px;
      transition: border 0.3s;
    }

    textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    .response-box {
      background: linear-gradient(135deg, #667eea15, #764ba215);
      padding: 25px;
      border-radius: 20px;
      margin: 20px 0;
      border-left: 5px solid #667eea;
      animation: slideIn 0.5s ease-out;
      color: #333;
      line-height: 1.8;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .loading {
      text-align: center;
      color: #667eea;
      font-size: 1.2em;
      padding: 30px;
    }

    .loading::after {
      content: '...';
      animation: dots 1.5s infinite;
    }

    @keyframes dots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60%, 100% { content: '...'; }
    }

    .activity-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .activity-card {
      background: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid #e0e0e0;
    }

    .activity-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      border-color: #667eea;
    }

    .activity-icon {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .activity-text {
      color: #333;
      font-weight: 600;
      font-size: 0.9em;
    }

    .tip-box {
      background: #fff3cd;
      border-left: 5px solid #ffc107;
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      color: #856404;
    }

    .mood-options {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .mood-btn {
      flex: 1;
      min-width: 150px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 10px;
      margin: 20px 0;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      width: 0%;
      animation: progress 2s ease-out forwards;
    }

    @keyframes progress {
      to { width: 100%; }
    }

    .quote-box {
      text-align: center;
      font-style: italic;
      color: #666;
      margin: 20px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
    }
  </style>
</head>
<body>
  <div class="container" id="app">
    <div class="emoji-header">üíô</div>
    <h1>Seu Espa√ßo de Bem-Estar</h1>
    <p class="subtitle">Estamos aqui para te ouvir e te ajudar ‚ú®</p>
    
    <button class="btn-primary" onclick="iniciarSentimentos()">
      üòä Como est√° se sentindo hoje?
    </button>
    
    <button class="btn-secondary" onclick="mostrarIdeias()">
      üí° Ideias do que fazer hoje
    </button>

    <div class="quote-box">
      "Cada dia √© uma nova oportunidade para ser feliz"
    </div>
  </div>

  <script>
    const API_KEY = "AIzaSyCSKfiCUgcK8lbNtitro94wfV_OlGbl2Xk";
    let historico = {
      textoUsuario: '',
      emocao: '',
      interacoes: 0
    };

    const frases = [
      "Acredite em voc√™, voc√™ √© incr√≠vel! üåü",
      "Pequenos passos levam a grandes conquistas üöÄ",
      "Voc√™ √© mais forte do que imagina üí™",
      "Hoje √© um √≥timo dia para ser feliz! ‚òÄÔ∏è"
    ];

    function trocarFrase() {
      const frase = frases[Math.floor(Math.random() * frases.length)];
      const quoteBox = document.querySelector('.quote-box');
      if (quoteBox) {
        quoteBox.style.opacity = '0';
        setTimeout(() => {
          quoteBox.textContent = `"${frase}"`;
          quoteBox.style.opacity = '1';
        }, 300);
      }
    }

    setInterval(trocarFrase, 5000);

    async function perguntarGemini(pergunta) {
      try {
        console.log('Enviando requisi√ß√£o para Gemini...');
        
        // CORRE√á√ÉO AQUI: Use o modelo correto e endpoint atualizado
        const resposta = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`,
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts: [{ text: pergunta }] }]
            })
          }
        );

        console.log('Status da resposta:', resposta.status);
        
        if (!resposta.ok) {
          const errorData = await resposta.json();
          console.error('Erro da API:', errorData);
          
          if (resposta.status === 400) {
            return "‚ö†Ô∏è A API Key parece estar inv√°lida ou mal configurada. Por favor, verifique sua chave do Gemini.";
          } else if (resposta.status === 403) {
            return "üîí Acesso negado. Sua API Key pode n√£o ter permiss√µes ou est√° bloqueada. Verifique no Google AI Studio.";
          } else if (resposta.status === 429) {
            return "‚è∞ Voc√™ atingiu o limite de requisi√ß√µes. Por favor, aguarde alguns minutos e tente novamente.";
          } else if (resposta.status === 404) {
            return "üîç Modelo n√£o encontrado. Tentando alternativa...";
          }
          
          return `‚ùå Erro ${resposta.status}: ${errorData.error?.message || 'Erro desconhecido'}. Verifique sua API Key.`;
        }
        
        const data = await resposta.json();
        console.log('Resposta recebida com sucesso!');
        
        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
          return data.candidates[0].content.parts[0].text;
        } else {
          console.error('Estrutura de resposta inesperada:', data);
          return "‚ö†Ô∏è Recebi uma resposta inv√°lida da API. Tente novamente.";
        }
        
      } catch (error) {
        console.error('Erro ao chamar Gemini:', error);
        return "üåê Erro de conex√£o. Verifique sua internet e se a API Key est√° correta. Detalhes: " + error.message;
      }
    }

    // Fun√ß√£o alternativa caso o modelo principal n√£o funcione
    async function perguntarGeminiAlternativo(pergunta) {
      try {
        console.log('Tentando modelo alternativo...');
        
        const resposta = await fetch(
          `https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${API_KEY}`,
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts: [{ text: pergunta }] }]
            })
          }
        );

        if (!resposta.ok) {
          throw new Error(`Erro ${resposta.status}`);
        }
        
        const data = await resposta.json();
        
        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
          return data.candidates[0].content.parts[0].text;
        } else {
          // Fallback para respostas locais se a API falhar
          return gerarRespostaLocal(pergunta);
        }
        
      } catch (error) {
        console.error('Erro no modelo alternativo:', error);
        return gerarRespostaLocal(pergunta);
      }
    }

    // Fallback local caso a API n√£o funcione
    function gerarRespostaLocal(pergunta) {
      const respostasLocais = [
        "Entendo como voc√™ se sente. Lembre-se que cada dia √© uma nova oportunidade para recome√ßar! üíô",
        "Voc√™ √© mais forte do que imagina. Continue seguindo em frente, um passo de cada vez! ‚ú®",
        "Os momentos dif√≠ceis n√£o duram para sempre. Voc√™ tem a for√ßa necess√°ria para superar isso! üåü",
        "Respire fundo e lembre-se: voc√™ j√° superou tantos desafios antes, e vai superar este tamb√©m! üí™",
        "A vida √© como as esta√ß√µes - depois do inverno, sempre vem a primavera. Melhores dias vir√£o! üå∏"
      ];
      
      return respostasLocais[Math.floor(Math.random() * respostasLocais.length)];
    }

    function iniciarSentimentos() {
      historico.interacoes++;
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üí≠</div>
        <h1>Conte-nos sobre o seu dia</h1>
        <p class="subtitle">Escreva livremente, estamos aqui para te ouvir</p>
        
        <div class="tip-box">
          üí° <strong>Dica:</strong> N√£o tenha medo de se expressar. Quanto mais voc√™ compartilhar, melhor poderemos te ajudar!
        </div>

        <textarea id='texto' placeholder='O que aconteceu hoje? Como voc√™ se sente? Conte-nos...'></textarea>
        
        <button class="btn-success" onclick="validarTexto()">
          ‚ú® Continuar
        </button>
        
        <button class="btn-back" onclick="voltarInicio()">
          ‚Üê Voltar
        </button>
      `;
    }

    function validarTexto() {
      const texto = document.getElementById('texto').value.trim();
      
      if (texto.length < 10) {
        alert('Por favor, escreva um pouco mais para que possamos te ajudar melhor! üòä');
        return;
      }

      historico.textoUsuario = texto;
      mostrarOpcoesSentimento();
    }

    function mostrarOpcoesSentimento() {
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üéØ</div>
        <h1>Como podemos te ajudar?</h1>
        <p class="subtitle">Escolha a op√ß√£o que mais combina com voc√™ agora</p>

        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
        
        <button class="btn-primary mood-btn" onclick="processarEmocao('feliz')">
          üòä Quero me sentir mais feliz
        </button>
        
        <button class="btn-secondary mood-btn" onclick="processarEmocao('triste')">
          üò¢ Preciso desabafar
        </button>
        
        <button class="btn-warning mood-btn" onclick="processarEmocao('conselho')">
          üí° Preciso de um conselho
        </button>

        <button class="btn-success mood-btn" onclick="processarEmocao('motivacao')">
          üöÄ Quero motiva√ß√£o
        </button>
        
        <button class="btn-back" onclick="iniciarSentimentos()">
          ‚Üê Voltar
        </button>
      `;
    }

    async function processarEmocao(tipo) {
      historico.emocao = tipo;
      
      document.getElementById('app').innerHTML = `
        <div class="loading">
          <div class="emoji-header">ü§î</div>
          <h2>Preparando algo especial para voc√™</h2>
        </div>
      `;

      let prompt = '';
      
      if (tipo === 'feliz') {
        prompt = `A pessoa disse: "${historico.textoUsuario}". 
        Responda de forma calorosa e motivacional, contando uma hist√≥ria inspiradora curta, 
        uma piada leve ou uma mensagem positiva que possa alegrar o dia dela. 
        Mantenha o tom amig√°vel e use emojis. M√°ximo 150 palavras.`;
      } else if (tipo === 'triste') {
        prompt = `A pessoa est√° passando por isso: "${historico.textoUsuario}". 
        Responda com empatia profunda, validando os sentimentos dela. 
        Seja um ouvinte compreensivo e ofere√ßa conforto genu√≠no. 
        Use um tom acolhedor e emp√°tico. M√°ximo 150 palavras.`;
      } else if (tipo === 'conselho') {
        prompt = `A pessoa compartilhou: "${historico.textoUsuario}". 
        D√™ um conselho pr√°tico, s√°bio e encorajador baseado na situa√ß√£o. 
        Seja espec√≠fico e ofere√ßa passos pr√°ticos que ela possa seguir. 
        Mantenha o tom amig√°vel e motivador. M√°ximo 150 palavras.`;
      } else if (tipo === 'motivacao') {
        prompt = `A pessoa disse: "${historico.textoUsuario}". 
        Crie uma mensagem super motivacional e energizante! 
        Fa√ßa ela sentir que pode conquistar qualquer coisa. 
        Use exemplos de supera√ß√£o e seja muito positivo. M√°ximo 150 palavras.`;
      }

      // Tenta a API principal primeiro, depois a alternativa, depois fallback local
      let resposta = await perguntarGemini(prompt);
      
      // Se a resposta principal falhar, tenta alternativa
      if (resposta.includes("Erro") || resposta.includes("n√£o encontrado") || resposta.includes("‚ö†Ô∏è")) {
        resposta = await perguntarGeminiAlternativo(prompt);
      }
      
      mostrarResposta(resposta, tipo);
    }

    function mostrarResposta(resposta, tipo) {
      let emoji = tipo === 'feliz' ? 'üòä' : tipo === 'triste' ? 'üíô' : tipo === 'motivacao' ? 'üöÄ' : 'üí°';
      
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">${emoji}</div>
        <h1>Mensagem para voc√™</h1>
        
        <div class="response-box">
          ${resposta}
        </div>

        <div class="tip-box">
          üíô Lembre-se: Voc√™ n√£o est√° sozinho(a). Sempre h√° algu√©m disposto a te ouvir e te ajudar!
        </div>
        
        <button class="btn-success" onclick="compartilharFeedback()">
          ‚≠ê Isso me ajudou!
        </button>

        <button class="btn-primary" onclick="mostrarOpcoesSentimento()">
          üîÑ Tentar outra op√ß√£o
        </button>
        
        <button class="btn-back" onclick="voltarInicio()">
          ‚Üê Voltar ao in√≠cio
        </button>
      `;
    }

    function compartilharFeedback() {
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üéâ</div>
        <h1>Que √≥timo saber disso!</h1>
        
        <div class="response-box">
          Ficamos muito felizes em ter ajudado! Voc√™ √© incr√≠vel e merece toda a felicidade do mundo. 
          Continue sempre acreditando em voc√™! üíô‚ú®
        </div>

        <div class="quote-box">
          "A felicidade est√° nas pequenas coisas, e voc√™ acabou de criar um momento feliz!" üåü
        </div>
        
        <button class="btn-primary" onclick="voltarInicio()">
          üè† Voltar ao in√≠cio
        </button>
      `;
    }

    function mostrarIdeias() {
      historico.interacoes++;
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üé®</div>
        <h1>O que voc√™ gostaria de fazer?</h1>
        <p class="subtitle">Escolha uma atividade para o seu bem-estar</p>

        <div class="activity-grid">
          <div class="activity-card" onclick="sugerirAtividade('relaxar')">
            <div class="activity-icon">üßò</div>
            <div class="activity-text">Relaxar</div>
          </div>

          <div class="activity-card" onclick="sugerirAtividade('divertir')">
            <div class="activity-icon">üéÆ</div>
            <div class="activity-text">Me divertir</div>
          </div>

          <div class="activity-card" onclick="sugerirAtividade('aprender')">
            <div class="activity-icon">üìö</div>
            <div class="activity-text">Aprender algo</div>
          </div>

          <div class="activity-card" onclick="sugerirAtividade('social')">
            <div class="activity-icon">üí¨</div>
            <div class="activity-text">Socializar</div>
          </div>

          <div class="activity-card" onclick="sugerirAtividade('exercicio')">
            <div class="activity-icon">üèÉ</div>
            <div class="activity-text">Me exercitar</div>
          </div>

          <div class="activity-card" onclick="sugerirAtividade('criativo')">
            <div class="activity-icon">üé®</div>
            <div class="activity-text">Ser criativo</div>
          </div>
        </div>
        
        <button class="btn-back" onclick="voltarInicio()">
          ‚Üê Voltar
        </button>
      `;
    }

    async function sugerirAtividade(tipo) {
      document.getElementById('app').innerHTML = `
        <div class="loading">
          <div class="emoji-header">‚ú®</div>
          <h2>Criando sugest√µes personalizadas para voc√™</h2>
        </div>
      `;

      let prompt = '';
      
      if (tipo === 'relaxar') {
        prompt = `Sugira 5 atividades relaxantes e detalhadas que uma pessoa pode fazer hoje. 
        Inclua op√ß√µes como medita√ß√£o, leitura, m√∫sica, etc. 
        Seja espec√≠fico e criativo. Use emojis e formata√ß√£o clara.`;
      } else if (tipo === 'divertir') {
        prompt = `Sugira 5 atividades divertidas e envolventes para fazer hoje. 
        Pode incluir jogos, filmes, hobbies, etc. 
        Seja entusiasmado e criativo. Use emojis.`;
      } else if (tipo === 'aprender') {
        prompt = `Sugira 5 formas interessantes de aprender algo novo hoje. 
        Pode incluir cursos online, document√°rios, livros, podcasts, etc. 
        Seja inspirador. Use emojis.`;
      } else if (tipo === 'social') {
        prompt = `Sugira 5 formas de socializar e conectar com outras pessoas hoje. 
        Pode incluir atividades presenciais e online. 
        Seja acolhedor e inclusivo. Use emojis.`;
      } else if (tipo === 'exercicio') {
        prompt = `Sugira 5 atividades f√≠sicas que algu√©m pode fazer hoje. 
        Inclua op√ß√µes para diferentes n√≠veis de energia. 
        Seja motivador e pr√°tico. Use emojis.`;
      } else if (tipo === 'criativo') {
        prompt = `Sugira 5 atividades criativas que algu√©m pode fazer hoje. 
        Pode incluir arte, escrita, m√∫sica, culin√°ria, etc. 
        Seja inspirador e imaginativo. Use emojis.`;
      }

      let resposta = await perguntarGemini(prompt);
      
      // Se a resposta principal falhar, tenta alternativa
      if (resposta.includes("Erro") || resposta.includes("n√£o encontrado") || resposta.includes("‚ö†Ô∏è")) {
        resposta = await perguntarGeminiAlternativo(prompt);
      }
      
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üéØ</div>
        <h1>Sugest√µes para voc√™</h1>
        
        <div class="response-box">
          ${resposta}
        </div>

        <div class="tip-box">
          üí° <strong>Dica:</strong> N√£o precisa fazer tudo de uma vez! Escolha o que mais te atrai agora e divirta-se! üòä
        </div>
        
        <button class="btn-primary" onclick="mostrarIdeias()">
          üîÑ Ver outras categorias
        </button>
        
        <button class="btn-back" onclick="voltarInicio()">
          ‚Üê Voltar ao in√≠cio
        </button>
      `;
    }

    function voltarInicio() {
      document.getElementById('app').innerHTML = `
        <div class="emoji-header">üíô</div>
        <h1>Seu Espa√ßo de Bem-Estar</h1>
        <p class="subtitle">Estamos aqui para te ouvir e te ajudar ‚ú®</p>
        
        <button class="btn-primary" onclick="iniciarSentimentos()">
          üòä Como est√° se sentindo hoje?
        </button>
        
        <button class="btn-secondary" onclick="mostrarIdeias()">
          üí° Ideias do que fazer hoje
        </button>

        <div class="quote-box">
          "Cada dia √© uma nova oportunidade para ser feliz"
        </div>
      `;
    }
  </script>
</body>
</html>